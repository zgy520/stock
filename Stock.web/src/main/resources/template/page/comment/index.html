<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>股票分析之评论</title>
    <script
            src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
    <link href="https://unpkg.com/tabulator-tables@4.4.3/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.4.3/dist/js/tabulator.min.js"></script>
</head>
<body>
    <button onclick="loadData()">加载数据</button>
    <button onclick="generateDataSet()">产生数据集</button>
    <div id="stockComment"></div>

    <script type="text/javascript">
        var table = new Tabulator("#stockComment",{
            height:"100%",
            layout:'fitColumns',
            pagination:'remote',
            paginationSize:'50',
            paginationSizeSelector:[100,250,500,800,1000,1200,1500,3000,5000],
            placeholder:'没有数据集',
            columns:[
                {
                    formatter:"rowSelection",titleFormatter:"rowSelection",headerSort:false,cellClick:function (e, cell) {
                        cell.getRow().toggleSelect();
                    }
                },
                {title:'id',field:'id',width:80},
                {title:'代码',field:'stockCode',width:150},
                {title:'评论',field:'comment',width:1150}
            ]
        });

        function loadData() {
            table.setData("/stock/comment/fetData")
        }

        function generateDataSet() {
            var selectedData = table.getSelectedData();
            console.log(selectedData);
            var selectedId = "";
            for(var i = 0; i < selectedData.length; i++){
                selectedId += selectedData[i].id + ",";
            }
            selectedId = selectedId.substr(0,selectedId.length -1);
            console.log(selectedId);
            $.ajax({
                url:'/stock/comment/generateDataSet',
                method:'post',
                data:{
                    idList: selectedId
                },
                success:function (result) {
                    console.log('SUCCESS！');
                }
            })
        }

    </script>
</body>
</html>